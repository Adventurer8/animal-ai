[INFO] Connected to Unity environment with package version 2.1.0-exp.1 and communication version 1.5.0
[INFO] Connected new brain: AnimalAI?team=0
[WARNING] The environment contains multiple observations. You must define allow_multiple_obs=True to receive them all. Otherwise, only the first visual observation (or vector observation ifthere are no visual observations) will be provided in the observation.
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Wrapping the env in a VecTransposeImage.
/home/roma/.local/lib/python3.10/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/buffers.py:219: UserWarning: This system does not have apparently enough memory to store the complete replay buffer 7.79GB > 1.58GB
  warnings.warn(
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 4        |
|    fps              | 122      |
|    time_elapsed     | 13       |
|    total timesteps  | 1668     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 8        |
|    fps              | 123      |
|    time_elapsed     | 27       |
|    total timesteps  | 3336     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 12       |
|    fps              | 124      |
|    time_elapsed     | 40       |
|    total timesteps  | 5004     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 16       |
|    fps              | 124      |
|    time_elapsed     | 53       |
|    total timesteps  | 6672     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 20       |
|    fps              | 124      |
|    time_elapsed     | 67       |
|    total timesteps  | 8340     |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 24       |
|    fps              | 147326   |
|    time_elapsed     | 0        |
|    total timesteps  | 10008    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 28       |
|    fps              | 883      |
|    time_elapsed     | 13       |
|    total timesteps  | 11676    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 32       |
|    fps              | 498      |
|    time_elapsed     | 26       |
|    total timesteps  | 13344    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 36       |
|    fps              | 374      |
|    time_elapsed     | 40       |
|    total timesteps  | 15012    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 40       |
|    fps              | 307      |
|    time_elapsed     | 54       |
|    total timesteps  | 16680    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 44       |
|    fps              | 272      |
|    time_elapsed     | 67       |
|    total timesteps  | 18348    |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 48       |
|    fps              | 129228   |
|    time_elapsed     | 0        |
|    total timesteps  | 20016    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 52       |
|    fps              | 1599     |
|    time_elapsed     | 13       |
|    total timesteps  | 21684    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 56       |
|    fps              | 865      |
|    time_elapsed     | 26       |
|    total timesteps  | 23352    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 60       |
|    fps              | 623      |
|    time_elapsed     | 40       |
|    total timesteps  | 25020    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 64       |
|    fps              | 500      |
|    time_elapsed     | 53       |
|    total timesteps  | 26688    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 68       |
|    fps              | 427      |
|    time_elapsed     | 66       |
|    total timesteps  | 28356    |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 72       |
|    fps              | 175688   |
|    time_elapsed     | 0        |
|    total timesteps  | 30024    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 76       |
|    fps              | 2320     |
|    time_elapsed     | 13       |
|    total timesteps  | 31692    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 80       |
|    fps              | 1224     |
|    time_elapsed     | 27       |
|    total timesteps  | 33360    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 84       |
|    fps              | 863      |
|    time_elapsed     | 40       |
|    total timesteps  | 35028    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 88       |
|    fps              | 682      |
|    time_elapsed     | 53       |
|    total timesteps  | 36696    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 92       |
|    fps              | 570      |
|    time_elapsed     | 67       |
|    total timesteps  | 38364    |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 96       |
|    fps              | 165086   |
|    time_elapsed     | 0        |
|    total timesteps  | 40032    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 100      |
|    fps              | 3070     |
|    time_elapsed     | 13       |
|    total timesteps  | 41700    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 104      |
|    fps              | 1613     |
|    time_elapsed     | 26       |
|    total timesteps  | 43368    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 108      |
|    fps              | 1115     |
|    time_elapsed     | 40       |
|    total timesteps  | 45036    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 112      |
|    fps              | 860      |
|    time_elapsed     | 54       |
|    total timesteps  | 46704    |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 116      |
|    fps              | 718      |
|    time_elapsed     | 67       |
|    total timesteps  | 48372    |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 120      |
|    fps              | 85208    |
|    time_elapsed     | 0        |
|    total timesteps  | 50040    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.00197  |
|    n_updates        | 9        |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 124      |
|    fps              | 2444     |
|    time_elapsed     | 21       |
|    total timesteps  | 51708    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.28e-06 |
|    n_updates        | 426      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 128      |
|    fps              | 1232     |
|    time_elapsed     | 43       |
|    total timesteps  | 53376    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.47e-06 |
|    n_updates        | 843      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 132      |
|    fps              | 848      |
|    time_elapsed     | 64       |
|    total timesteps  | 55044    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.23e-06 |
|    n_updates        | 1260     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 136      |
|    fps              | 660      |
|    time_elapsed     | 85       |
|    total timesteps  | 56712    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 5.3e-07  |
|    n_updates        | 1677     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 140      |
|    fps              | 543      |
|    time_elapsed     | 107      |
|    total timesteps  | 58380    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.07e-06 |
|    n_updates        | 2094     |
----------------------------------
Logging to ./dqn_tensorboard/inserrunname/DQN_5
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 144      |
|    fps              | 96863    |
|    time_elapsed     | 0        |
|    total timesteps  | 60048    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 8.2e-07  |
|    n_updates        | 2511     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 148      |
|    fps              | 2859     |
|    time_elapsed     | 21       |
|    total timesteps  | 61716    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 3.91e-06 |
|    n_updates        | 2928     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 152      |
|    fps              | 1493     |
|    time_elapsed     | 42       |
|    total timesteps  | 63384    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 5.98e-07 |
|    n_updates        | 3345     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 417      |
|    ep_rew_mean      | -0.999   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 156      |
|    fps              | 1019     |
|    time_elapsed     | 63       |
|    total timesteps  | 65052    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 5.14e-07 |
|    n_updates        | 3762     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 416      |
|    ep_rew_mean      | -0.977   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 160      |
|    fps              | 789      |
|    time_elapsed     | 84       |
|    total timesteps  | 66639    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 2.8e-06  |
|    n_updates        | 4159     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 408      |
|    ep_rew_mean      | -0.939   |
|    exploration rate | 0.05     |
| time/               |          |
|    episodes         | 164      |
|    fps              | 706      |
|    time_elapsed     | 95       |
|    total timesteps  | 67525    |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.21e-07 |
|    n_updates        | 4381     |
----------------------------------
Traceback (most recent call last):
  File "/home/roma/animal-ai/examples/gymwrapper.py", line 143, in <module>
    )
  File "/home/roma/animal-ai/examples/gymwrapper.py", line 124, in train_agent_single_config
    model.learn(no_steps, reset_num_timesteps=reset_num_timesteps)
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/dqn/dqn.py", line 241, in learn
    return super(DQN, self).learn(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 352, in learn
    rollout = self.collect_rollouts(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 571, in collect_rollouts
    new_obs, reward, done, infos = env.step(action)
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 162, in step
    return self.step_wait()
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_transpose.py", line 83, in step_wait
    observations, rewards, dones, infos = self.venv.step_wait()
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 43, in step_wait
    obs, self.buf_rews[env_idx], self.buf_dones[env_idx], self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/monitor.py", line 90, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/roma/.local/lib/python3.10/site-packages/gym_unity/envs/__init__.py", line 201, in step
    self._env.step()
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/timers.py", line 305, in wrapped
    return func(*args, **kwargs)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/environment.py", line 348, in step
    outputs = self._communicator.exchange(step_input, self._poll_process)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 142, in exchange
    self.poll_for_timeout(poll_callback)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 106, in poll_for_timeout
    if self.unity_to_external.parent_conn.poll(callback_timeout_wait):
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/roma/animal-ai/examples/gymwrapper.py", line 143, in <module>
    )
  File "/home/roma/animal-ai/examples/gymwrapper.py", line 124, in train_agent_single_config
    model.learn(no_steps, reset_num_timesteps=reset_num_timesteps)
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/dqn/dqn.py", line 241, in learn
    return super(DQN, self).learn(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 352, in learn
    rollout = self.collect_rollouts(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 571, in collect_rollouts
    new_obs, reward, done, infos = env.step(action)
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 162, in step
    return self.step_wait()
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_transpose.py", line 83, in step_wait
    observations, rewards, dones, infos = self.venv.step_wait()
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 43, in step_wait
    obs, self.buf_rews[env_idx], self.buf_dones[env_idx], self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/home/roma/.local/lib/python3.10/site-packages/stable_baselines3/common/monitor.py", line 90, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/roma/.local/lib/python3.10/site-packages/gym_unity/envs/__init__.py", line 201, in step
    self._env.step()
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/timers.py", line 305, in wrapped
    return func(*args, **kwargs)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/environment.py", line 348, in step
    outputs = self._communicator.exchange(step_input, self._poll_process)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 142, in exchange
    self.poll_for_timeout(poll_callback)
  File "/home/roma/.local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 106, in poll_for_timeout
    if self.unity_to_external.parent_conn.poll(callback_timeout_wait):
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/usr/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1537, in _shutdown
    atexit_call()
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 31, in _python_exit
    t.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt: